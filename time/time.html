<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°ç£æ™‚é–“èˆ‡ç¾è‹±è‚¡å¸‚ç‹€æ…‹</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 0;
            overflow-x: hidden;
        }
        
        .container {
            background: rgba(255, 255, 255, 0.98);
            min-height: 100vh;
            padding: env(safe-area-inset-top, 20px) 16px env(safe-area-inset-bottom, 20px) 16px;
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 24px;
            font-size: 26px;
            font-weight: 700;
            padding-top: 12px;
        }
        
        .clock {
            text-align: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 32px 20px;
            border-radius: 20px;
            margin-bottom: 24px;
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.4);
        }
        
        .time {
            font-size: 56px;
            font-weight: 700;
            margin-bottom: 8px;
            letter-spacing: -1px;
            font-variant-numeric: tabular-nums;
        }
        
        .date {
            font-size: 17px;
            opacity: 0.95;
            font-weight: 500;
        }
        
        .market {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(0, 0, 0, 0.06);
        }
        
        .market:active {
            transform: scale(0.98);
            transition: transform 0.1s;
        }
        
        .market-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
            gap: 12px;
        }
        
        .market-name {
            font-size: 22px;
            font-weight: 700;
            color: #1a1a1a;
            line-height: 1.3;
            flex: 1;
        }
        
        .market-status-wrapper {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 6px;
        }
        
        .market-status {
            padding: 8px 16px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 15px;
            white-space: nowrap;
            letter-spacing: 0.3px;
        }
        
        .status-open {
            background: #10b981;
            color: white;
        }
        
        .status-pre {
            background: #f59e0b;
            color: white;
        }
        
        .status-post {
            background: #6366f1;
            color: white;
        }
        
        .status-closed {
            background: #ef4444;
            color: white;
        }
        
        .dst-indicator {
            padding: 4px 10px;
            background: #f3f4f6;
            border-radius: 8px;
            font-size: 12px;
            color: #6b7280;
            font-weight: 600;
            white-space: nowrap;
        }
        
        .market-time {
            color: #6b7280;
            font-size: 15px;
            margin-top: 4px;
            line-height: 1.5;
            font-weight: 500;
        }
        
        .market:last-child {
            margin-bottom: 0;
        }
        
        @media (max-width: 390px) {
            .time {
                font-size: 48px;
            }
            
            .market-name {
                font-size: 20px;
            }
            
            .market-status {
                font-size: 14px;
                padding: 7px 14px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ• å°ç£æ™‚é–“èˆ‡ç¾è‹±è‚¡å¸‚ç‹€æ…‹</h1>
        
        <div class="clock">
            <div class="time" id="time">--:--:--</div>
            <div class="date" id="date">----å¹´--æœˆ--æ—¥ æ˜ŸæœŸ-</div>
        </div>
        
        <div class="market" id="us-market">
            <div class="market-header">
                <span class="market-name">ğŸ‡ºğŸ‡¸ ç¾è‚¡ (å˜‰ä¿¡è­‰åˆ¸)</span>
                <span class="market-status" id="us-status">è¼‰å…¥ä¸­...</span>
            </div>
            <div class="market-time" id="us-time"></div>
        </div>
        
        <div class="market" id="uk-market">
            <div class="market-header">
                <span class="market-name">ğŸ‡¬ğŸ‡§ è‹±è‚¡ (å€«æ•¦è­‰äº¤æ‰€)</span>
                <span class="market-status" id="uk-status">è¼‰å…¥ä¸­...</span>
            </div>
            <div class="market-time" id="uk-time"></div>
        </div>
    </div>

    <script>
        // åˆ¤æ–·æ˜¯å¦ç‚ºå¤ä»¤æ™‚é–“ (ç¾åœ‹)
        function isUSDST(date) {
            const year = date.getUTCFullYear();
            // ç¾åœ‹å¤ä»¤æ™‚ï¼š3æœˆç¬¬äºŒå€‹æ˜ŸæœŸæ—¥ 02:00 ~ 11æœˆç¬¬ä¸€å€‹æ˜ŸæœŸæ—¥ 02:00
            const marchSecondSunday = new Date(Date.UTC(year, 2, 1, 2, 0, 0));
            marchSecondSunday.setUTCDate(1 + (7 - marchSecondSunday.getUTCDay()) + 7);
            
            const novemberFirstSunday = new Date(Date.UTC(year, 10, 1, 2, 0, 0));
            novemberFirstSunday.setUTCDate(1 + (7 - novemberFirstSunday.getUTCDay()));
            
            return date >= marchSecondSunday && date < novemberFirstSunday;
        }
        
        // åˆ¤æ–·æ˜¯å¦ç‚ºå¤ä»¤æ™‚é–“ (è‹±åœ‹)
        function isUKDST(date) {
            const year = date.getUTCFullYear();
            // è‹±åœ‹å¤ä»¤æ™‚ï¼š3æœˆæœ€å¾Œä¸€å€‹æ˜ŸæœŸæ—¥ 01:00 ~ 10æœˆæœ€å¾Œä¸€å€‹æ˜ŸæœŸæ—¥ 01:00
            const marchLastSunday = new Date(Date.UTC(year, 3, 1, 1, 0, 0));
            marchLastSunday.setUTCDate(0); // ä¸Šå€‹æœˆæœ€å¾Œä¸€å¤©
            marchLastSunday.setUTCDate(marchLastSunday.getUTCDate() - marchLastSunday.getUTCDay());
            
            const octoberLastSunday = new Date(Date.UTC(year, 10, 1, 1, 0, 0));
            octoberLastSunday.setUTCDate(0);
            octoberLastSunday.setUTCDate(octoberLastSunday.getUTCDate() - octoberLastSunday.getUTCDay());
            
            return date >= marchLastSunday && date < octoberLastSunday;
        }
        
        function getMarketStatus() {
            const now = new Date();
            const taiwanTime = new Date(now.toLocaleString('en-US', { timeZone: 'Asia/Taipei' }));
            
            // ç¾è‚¡æ™‚é–“ (è€ƒæ…®å¤ä»¤æ™‚é–“)
            const isDST_US = isUSDST(now);
            const usOffset = isDST_US ? -4 : -5; // EDT: UTC-4, EST: UTC-5
            const usTime = new Date(now.getTime() + (usOffset * 60 + 480) * 60000); // 480 = å°ç£ UTC+8
            const usHour = usTime.getHours();
            const usMinute = usTime.getMinutes();
            const usTotalMinutes = usHour * 60 + usMinute;
            const usDay = usTime.getDay();
            
            // è‹±è‚¡æ™‚é–“ (è€ƒæ…®å¤ä»¤æ™‚é–“)
            const isDST_UK = isUKDST(now);
            const ukOffset = isDST_UK ? 1 : 0; // BST: UTC+1, GMT: UTC+0
            const ukTime = new Date(now.getTime() + (ukOffset * 60 - 480) * 60000);
            const ukHour = ukTime.getHours();
            const ukMinute = ukTime.getMinutes();
            const ukTotalMinutes = ukHour * 60 + ukMinute;
            const ukDay = ukTime.getDay();
            
            // ç¾è‚¡ç‹€æ…‹åˆ¤æ–· (é€±ä¸€åˆ°é€±äº”)
            let usStatus, usStatusText, usTimeInfo;
            if (usDay === 0 || usDay === 6) {
                usStatus = 'status-closed';
                usStatusText = 'ä¼‘å¸‚';
                usTimeInfo = `ç•¶åœ°æ™‚é–“: ${usTime.toLocaleTimeString('zh-TW', {hour: '2-digit', minute: '2-digit'})}`;
            } else {
                // ç›¤å‰: 04:00-09:30 (240-570åˆ†é˜)
                // ç›¤ä¸­: 09:30-16:00 (570-960åˆ†é˜)
                // ç›¤å¾Œ: 16:00-20:00 (960-1200åˆ†é˜)
                if (usTotalMinutes >= 240 && usTotalMinutes < 570) {
                    usStatus = 'status-pre';
                    usStatusText = 'ç›¤å‰äº¤æ˜“';
                    usTimeInfo = `ç•¶åœ°æ™‚é–“: ${usTime.toLocaleTimeString('zh-TW', {hour: '2-digit', minute: '2-digit'})} | ç›¤å‰ 04:00-09:30`;
                } else if (usTotalMinutes >= 570 && usTotalMinutes < 960) {
                    usStatus = 'status-open';
                    usStatusText = 'é–‹ç›¤ä¸­';
                    usTimeInfo = `ç•¶åœ°æ™‚é–“: ${usTime.toLocaleTimeString('zh-TW', {hour: '2-digit', minute: '2-digit'})} | é–‹ç›¤ 09:30-16:00`;
                } else if (usTotalMinutes >= 960 && usTotalMinutes < 1200) {
                    usStatus = 'status-post';
                    usStatusText = 'ç›¤å¾Œäº¤æ˜“';
                    usTimeInfo = `ç•¶åœ°æ™‚é–“: ${usTime.toLocaleTimeString('zh-TW', {hour: '2-digit', minute: '2-digit'})} | ç›¤å¾Œ 16:00-20:00`;
                } else {
                    usStatus = 'status-closed';
                    usStatusText = 'æ”¶ç›¤';
                    usTimeInfo = `ç•¶åœ°æ™‚é–“: ${usTime.toLocaleTimeString('zh-TW', {hour: '2-digit', minute: '2-digit'})}`;
                }
            }
            
            // è‹±è‚¡ç‹€æ…‹åˆ¤æ–· (é€±ä¸€åˆ°é€±äº”)
            let ukStatus, ukStatusText, ukTimeInfo;
            if (ukDay === 0 || ukDay === 6) {
                ukStatus = 'status-closed';
                ukStatusText = 'ä¼‘å¸‚';
                ukTimeInfo = `ç•¶åœ°æ™‚é–“: ${ukTime.toLocaleTimeString('zh-TW', {hour: '2-digit', minute: '2-digit'})}`;
            } else {
                // é–‹ç›¤: 08:00-16:30 (480-990åˆ†é˜)
                if (ukTotalMinutes >= 480 && ukTotalMinutes < 990) {
                    ukStatus = 'status-open';
                    ukStatusText = 'é–‹ç›¤ä¸­';
                    ukTimeInfo = `ç•¶åœ°æ™‚é–“: ${ukTime.toLocaleTimeString('zh-TW', {hour: '2-digit', minute: '2-digit'})} | é–‹ç›¤ 08:00-16:30`;
                } else {
                    ukStatus = 'status-closed';
                    ukStatusText = 'æ”¶ç›¤';
                    ukTimeInfo = `ç•¶åœ°æ™‚é–“: ${ukTime.toLocaleTimeString('zh-TW', {hour: '2-digit', minute: '2-digit'})}`;
                }
            }
            
            return {
                us: { status: usStatus, text: usStatusText, time: usTimeInfo, dst: isDST_US },
                uk: { status: ukStatus, text: ukStatusText, time: ukTimeInfo, dst: isDST_UK }
            };
        }
        
        function updateClock() {
            const now = new Date();
            const taiwanTime = new Date(now.toLocaleString('en-US', { timeZone: 'Asia/Taipei' }));
            
            // æ›´æ–°å°ç£æ™‚é–“
            const timeStr = taiwanTime.toLocaleTimeString('zh-TW', { 
                hour: '2-digit', 
                minute: '2-digit', 
                second: '2-digit',
                hour12: false 
            });
            
            const dateStr = taiwanTime.toLocaleDateString('zh-TW', { 
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                weekday: 'long'
            });
            
            document.getElementById('time').textContent = timeStr;
            document.getElementById('date').textContent = dateStr;
            
            // æ›´æ–°å¸‚å ´ç‹€æ…‹
            const markets = getMarketStatus();
            
            // æ›´æ–°ç¾è‚¡
            const usStatusEl = document.getElementById('us-status');
            usStatusEl.className = 'market-status ' + markets.us.status;
            usStatusEl.innerHTML = markets.us.text + (markets.us.dst ? '<span class="dst-indicator">å¤ä»¤æ™‚é–“</span>' : '<span class="dst-indicator">æ¨™æº–æ™‚é–“</span>');
            document.getElementById('us-time').textContent = markets.us.time;
            
            // æ›´æ–°è‹±è‚¡
            const ukStatusEl = document.getElementById('uk-status');
            ukStatusEl.className = 'market-status ' + markets.uk.status;
            ukStatusEl.innerHTML = markets.uk.text + (markets.uk.dst ? '<span class="dst-indicator">å¤ä»¤æ™‚é–“</span>' : '<span class="dst-indicator">æ¨™æº–æ™‚é–“</span>');
            document.getElementById('uk-time').textContent = markets.uk.time;
        }
        
        // åˆå§‹æ›´æ–°
        updateClock();
        
        // æ¯ç§’æ›´æ–°
        setInterval(updateClock, 1000);
    </script>
</body>
</html>
